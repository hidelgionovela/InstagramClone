(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{a00b:function(t,a,o){"use strict";o.r(a);var e=function(){var t=this,a=t._self._c;return a("q-page",{staticClass:"constrain-more q-pa-md"},[a("div",{staticClass:"camera-frame q-pa-md"},[a("video",{directives:[{name:"show",rawName:"v-show",value:!t.imageCaptured,expression:"!imageCaptured"}],ref:"video",staticClass:"full-width",attrs:{autoplay:""}}),a("canvas",{directives:[{name:"show",rawName:"v-show",value:t.imageCaptured,expression:"imageCaptured"}],ref:"canvas",staticClass:"full-width",attrs:{height:"240"}})]),a("div",{staticClass:"text-center q-pa-md"},[t.hasCameraSupport?a("q-btn",{attrs:{disable:t.imageCaptured,round:"",color:"primary",size:"lg",icon:"las la-camera"},on:{click:t.captureImage}}):a("q-file",{attrs:{color:"purple-12",label:"Escolha uma foto",accept:"image/*"},on:{input:t.captureImageFallback},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"eva-attach-outline"}})]},proxy:!0}]),model:{value:t.imageUpload,callback:function(a){t.imageUpload=a},expression:"imageUpload"}}),a("div",{staticClass:"row justify-center q-ma-md"},[a("q-input",{staticClass:"col col-sm-7",attrs:{label:"Legenda (escreva a legenda) *",dense:""},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"eva-edit-2-outline"}})]},proxy:!0}]),model:{value:t.post.caption,callback:function(a){t.$set(t.post,"caption",a)},expression:"post.caption"}})],1),a("div",{staticClass:"row justify-center q-ma-md"},[a("q-input",{staticClass:"col col-sm-7",attrs:{loading:t.locationLoading,label:"Localiza√ß√£o (clique no icon)",dense:""},scopedSlots:t._u([{key:"append",fn:function(){return[!t.locationLoading&&t.locationSuported?a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"eva-navigation-2-outline"},on:{click:t.getLocation}}):t._e()]},proxy:!0}]),model:{value:t.post.location,callback:function(a){t.$set(t.post,"location",a)},expression:"post.location"}})],1),a("div",{staticClass:"row justify-center q-mt-lg"},[a("q-btn",{attrs:{disable:!t.post.caption||!t.post.photo,unelevated:"",rounded:"",color:"primary",label:"Postar Foto"},on:{click:t.addPost}})],1)],1)])},i=[],n=(o("d3b7"),o("159b"),o("81b2"),o("0eb6"),o("b7ef"),o("8bd4"),o("ac1f"),o("1276"),o("c19f"),o("e260"),o("5cc6"),o("907a"),o("9a8c"),o("a975"),o("735e"),o("c1ac"),o("d139"),o("3a7b"),o("d5d6"),o("82f8"),o("e91f"),o("60bd"),o("5f96"),o("3280"),o("3fcc"),o("ca91"),o("25a1"),o("cd26"),o("3c5d"),o("2954"),o("649e"),o("219c"),o("170b"),o("b39a"),o("72f7"),o("fa9e"),o("77d9"),o("99af"),o("fed6"),o("1732"));o("121f");var s={name:"PageCamera",data:function(){return{post:{id:Object(n["a"])(),caption:"",location:"",photo:null,date:Date.now()},imageCaptured:!1,imageUpload:[],hasCameraSupport:!0,locationLoading:!1}},computed:{locationSuported:function(){return"geolocation"in navigator}},methods:{initCamera:function(){var t=this;navigator.mediaDevices.getUserMedia({video:!0}).then((function(a){t.$refs.video.srcObject=a})).catch((function(a){t.hasCameraSupport=!1}))},captureImage:function(){var t=this.$refs.video,a=this.$refs.canvas;a.width=t.getBoundingClientRect().width,a.height=t.getBoundingClientRect().height;var o=a.getContext("2d");o.drawImage(t,0,0,a.width,a.height),this.imageCaptured=!0,this.post.photo=this.dataURItoBlob(a.toDataURL()),this.disableCamera()},captureImageFallback:function(t){var a=this;this.post.photo=t;var o=this.$refs.canvas,e=o.getContext("2d"),i=new FileReader;i.onload=function(t){var i=new Image;i.onload=function(){o.width=i.width,o.height=i.height,e.drawImage(i,0,0),a.imageCaptured=!0},i.src=t.target.result},i.readAsDataURL(t)},disableCamera:function(){this.$refs.video.srcObject.getVideoTracks().forEach((function(t){t.stop()}))},dataURItoBlob:function(t){for(var a=atob(t.split(",")[1]),o=t.split(",")[0].split(":")[1].split(";")[0],e=new ArrayBuffer(a.length),i=new Uint8Array(e),n=0;n<a.length;n++)i[n]=a.charCodeAt(n);return new Blob([e],{type:o})},getLocation:function(){var t=this;this.locationLoading=!0,navigator.geolocation.getCurrentPosition((function(a){t.getCityAndCountry(a)}),(function(a){t.locationError()}),{timeout:7e3})},getCityAndCountry:function(t){var a=this,o="https://geocode.xyz/".concat(t.coords.latitude,",").concat(t.coords.longitude,"?json=1");this.$axios.get(o).then((function(t){a.locationSuccess(t)})).catch((function(t){a.locationError()}))},locationSuccess:function(t){this.post.location=t.data.city,t.data.country&&(this.post.location+=", ".concat(t.data.country)),this.locationLoading=!1},locationError:function(){this.$q.dialog({title:"Erro 404üò™!",message:"N√£o foi encontrada tua localiza√ß√£o queira por favor digitar ou tentar mais uma vezüòå!"}),this.locationLoading=!1},addPost:function(){var t=this;this.$q.loading.show();var a=new FormData;a.append("id",this.post.id),a.append("caption",this.post.caption),a.append("location",this.post.location),a.append("date",this.post.date),a.append("file",this.post.photo,this.post.id+".png"),this.$axios.post("".concat("https://instabackend9la.herokuapp.com","/createPost"),a).then((function(a){console.log("response: ",a),t.$router.push("/"),t.$q.notify({message:"Post criado.",color:"primary",actions:[{label:"Fechar",color:"white",handler:function(){}}]}),t.$q.loading.hide()})).catch((function(a){console.log("err: ",a),t.$q.dialog({title:"Erro üò™!",message:"Desculpe, N√£o foi possivel criar o postüòå!"}),t.$q.loading.hide()}))}},mounted:function(){this.initCamera()},beforeDestroy:function(){this.hasCameraSupport&&this.disableCamera()}},c=s,r=(o("a565"),o("2877")),l=o("9989"),d=o("9c40"),p=o("7d53"),u=o("0016"),h=o("27f9"),f=o("eebe"),g=o.n(f),m=Object(r["a"])(c,e,i,!1,null,null,null);a["default"]=m.exports;g()(m,"components",{QPage:l["a"],QBtn:d["a"],QFile:p["a"],QIcon:u["a"],QInput:h["a"]})},a565:function(t,a,o){"use strict";o("b6bb")},b6bb:function(t,a,o){}}]);